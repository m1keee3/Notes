# Задачи сетевой коммуникации. Модель OSI (Open Systems Interconnection model))

## Проблемы сетевой коммуникации

### Архитектурные аспекты:
- Взаимодействие разнородных систем (ОС, кодировки, разрядность)
- Работа через разное оборудование в одном сеансе связи
- Организационное разграничение управления в крупных сетях

### Технические аспекты:
- **Задержка (Latency)** – переменное время передачи данных
- **Пропускная способность (Bandwidth)** – объем данных за время, стабильность канала
- **Помехи (Interference)** – искажение сигнала
- **Потеря пакетов (Packet loss)**
- **Угрозы безопасности** – DoS, аутентификация, авторизация
- **Проблемы конфигурации и совместимости**
- **Масштабируемость** – сложность при росте сети

---

## Модель OSI

### Предпосылки появления:
- Решение организационных и технических проблем
- Монолиты 
- Потребность в открытых стандартах
- Совместное использование лучших компонентов

### Основные принципы:
- Логически изолированные этапы коммуникации
- Реализация в виде «чёрных ящиков»
- Регламентация интерфейсов
- Описание функций без алгоритмов

---

## Уровни модели OSI

| Уровень       | Назначение                                                  | Примеры протоколов                |
| ------------- | ----------------------------------------------------------- | --------------------------------- |
| Прикладной    | Интерфейс для приложений, передача файлов, данных           | HTTP, HTTPS, FTP, SMTP, DNS, DHCP |
| Представления | Сжатие, шифрование, кодировка                               | SSL, TLS, ASCII, Unicode          |
| Сеансовый     | Установление, управление и завершение сеансов               | RPC                               |
| Транспортный  | Надёжная передача данных, контроль ошибок, порядок данных   | TCP, UDP, SCTP                    |
| Сетевой       | Доставка данных по составной сети, маршрутизация, адресация | IPv4, IPv6, ICMP, RIP, BGP, ARP   |
| Канальный     | Передача кадров между узлами в LAN, обнаружение ошибок      | Ethernet, Wi-Fi, Bluetooth        |
| Физический    | Передача битов через кабели, разъёмы, сигналы               | IEEE 802.11, RS-232, DSL, ISDN    |

---

## Взаимодействие уровней
![[Pasted image 20251006154157.png]]

Каждый уровень логически взаимодействует с таким же уровнем на другой системе, при этом на самом деле используются уровни ниже.

## Сегментация при передаче

![[Pasted image 20251006154623.png]]

На практике при передаче большого файла TCP разбивает его на **сегменты.**

---

## Инкапсуляция и декапсуляция

- Каждый уровень добавляет свой заголовок к данным
- При передаче: данные «опускаются» вниз по стеку, добавляются заголовки
- При приёме: данные «поднимаются» вверх, заголовки снимаются

Пример из Wireshark:
- **Кадр канального уровня**: MAC-адреса, тип (IPv4)
- **Пакет сетевого уровня**: IP-адреса, TTL, протокол
- **Сегмент транспортного уровня**: порты, номера последовательностей, флаги
- **Сообщение прикладного уровня**: HTTP-заголовки, данные

---

## Зачем нужна многоуровневая адресация?

- Канальный уровень: MAC-адреса (локальная сеть)
- Сетевой уровень: IP-адреса (глобальная сеть)
- Позволяет:
  - Использовать одинаковые MAC-адреса в разных сетях
  - Обеспечивать уникальность IP-адресов в составной сети
  - Абстрагироваться от физических технологий

---

## Взаимодействие сетевого и канального уровней

![[Pasted image 20251006161503.png]]


#### 1. Канальный адрес (MAC-адрес)

- **Что это:** Физический, "железный" адрес сетевого оборудования
    
- **Формат:** 48-битный номер (например: `00:1e:67:26:fd:32`)
    
- **Особенности:**
    
    - Уникален для каждого сетевого устройства
        
    - Действует только в пределах одной локальной сети
        
    - Не может быть изменен (прошивается производителем)
        
- **На схеме:** Обозначен как `aaa`, `aba`, `dbb`, `dfv`, `dbe`
    

#### 2. Сетевой адрес (IP-адрес)

- **Что это:** Логический адрес в составной сети
    
- **Формат:** На схеме упрощенно показан как `[номер сети]-[номер узла]`
    
- **Особенности:**
    
    - Назначается администратором или автоматически
        
    - Действует во всей составной сети
        
    - Должен быть уникальным в рамках всей сети
        
- **На схеме:** `1-1`, `1-3`, `2-1`, `2-2`, `3-2`, `3-3`
    

#### 3. Шлюз по умолчанию (Default Gateway)

- **Что это:** Маршрутизатор, через который узел отправляет трафик в другие сети
    
- **Назначение:** "Выходные ворота" из локальной сети
    
- **На схеме:** Для узла `1-1` шлюзом является маршрутизатор M1 с адресом `1-3`
    

#### 4. Таблица маршрутизации

- **Что это:** База данных в маршрутизаторе, которая указывает куда отправлять пакеты
    
- **Формат на схеме:** `[Сеть]-[Порт]-[Шлюз]`
    
- **Пример:** `[3-0]-[2-1]-[2-2]` означает: "Для достижения сети 3 используй порт 2-1 и отправляй на шлюз 2-2"
### Практический пример работы схемы

#### Сценарий: Узел `1-1` отправляет данные узлу `3-3`

#### Шаг 1: Принятие решения на узле-отправителе

1. **Узел `1-1`** хочет отправить пакет узлу `3-3`
    
2. **Анализ адресов:**
    
    - Мой сетевой адрес: `1-1`
        
    - Адрес назначения: `3-3`
        
    - Сетевые части разные (`1` ≠ `3`) → узел в другой сети
        
3. **Решение:** Отправить пакет на шлюз по умолчанию `1-3` (M1)

#### Шаг 2: Создание кадра в Сети I

```
КАДР от узла 1-1 к маршрутизатору M1:
- Канальный уровень:
  - Source MAC: aaa (узел 1-1)
  - Destination MAC: aba (M1 порт 1-3)
- Сетевой уровень:
  - Source IP: 1-1
  - Destination IP: 3-3
- Данные: [полезная нагрузка]
```


#### Шаг 3: Обработка на маршрутизаторе M1

1. **Получение:** M1 получает кадр на порту `1-3`
    
2. **Анализ таблицы маршрутизации M1:**
```
	[1-0]-[1-3]-[1-3]  → Сеть 1 подключена напрямую
	[2-0]-[2-1]-[2-1]  → Сеть 2 подключена напрямую  
	[3-0]-[2-1]-[2-2]  → Для сети 3 отправлять через порт 2-1 на шлюз 2-2
```
    
3. **Решение:** Отправить пакет на M2 (`2-2`) через порт `2-1`
    

### Шаг 4: Создание нового кадра в Сети II

text

КАДР от M1 к M2:
- Канальный уровень:
  - Source MAC: dbb (M1 порт 2-1)
  - Destination MAC: dfv (M2 порт 2-2)
- Сетевой уровень (неизменен!):
  - Source IP: 1-1
  - Destination IP: 3-3
- Данные: [полезная нагрузка]

### Шаг 5: Обработка на маршрутизаторе M2

1. **Получение:** M2 получает кадр на порту `2-2`
    
2. **Анализ таблицы маршрутизации M2:**
```
	[1-0]-[2-2]-[2-1]  → Для сети 1 отправлять через порт 2-2 на шлюз 2-1
    [2-0]-[2-2]-[2-2]  → Сеть 2 подключена напрямую
    [3-0]-[3-2]-[3-2]  → Сеть 3 подключена напрямую
```
    
3. **Решение:** Узел `3-3` находится в непосредственно подключенной Сети III
    

### Шаг 6: Доставка в Сети III

text

КАДР от M2 к узлу 3-3:
- Канальный уровень:
  - Source MAC: aaa (M2 порт 3-2)
  - Destination MAC: dbe (узел 3-3)
- Сетевой уровень (неизменен!):
  - Source IP: 1-1
  - Destination IP: 3-3
- Данные: [полезная нагрузка]
---
## Выводы

- Модель OSI – основа для понимания сетевых технологий
- Даёт:
  - Идеологию проектирования сетей
  - Терминологию для обсуждения
  - Понимание взаимодействия компонентов
- Многоуровневая адресация и инкапсуляция – ключевые механизмы работы сетей
